<!--
  ~ Copyright (C) 2009 eXo Platform SAS.
  ~
  ~ This is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU Lesser General Public License as
  ~ published by the Free Software Foundation; either version 2.1 of
  ~ the License, or (at your option) any later version.
  ~
  ~ This software is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  ~ Lesser General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public
  ~ License along with this software; if not, write to the Free
  ~ Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
  ~ 02110-1301 USA, or see the FSF site: http://www.fsf.org.
  -->
<jbosscache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="urn:jboss:jbosscache-core:config:3.1">

	<locking useLockStriping="false" concurrencyLevel="50000" lockParentForChildInsertRemove="false" lockAcquisitionTimeout="20000" />
	<!-- Configure the TransactionManager -->
	<transaction
		transactionManagerLookupClass="org.jboss.cache.transaction.JBossStandaloneJTAManagerLookup" />

	<clustering mode="replication" clusterName="JBoss-Cache-Indexer-Cluster_system">
		<stateRetrieval timeout="20000" fetchInMemoryState="false"  nonBlocking="true"/>
		<jgroupsConfig>
			<TCP bind_addr="127.0.0.1" start_port="9700" loopback="true"
				recv_buf_size="20000000" send_buf_size="640000"
				discard_incompatible_packets="true" max_bundle_size="64000"
				max_bundle_timeout="30" use_incoming_packet_handler="true"
				enable_bundling="false" use_send_queues="false" sock_conn_timeout="300"
				skip_suspected_members="true" use_concurrent_stack="true"
				thread_pool.enabled="true" thread_pool.min_threads="1"
				thread_pool.max_threads="25" thread_pool.keep_alive_time="5000"
				thread_pool.queue_enabled="false" thread_pool.queue_max_size="100"
				thread_pool.rejection_policy="run" oob_thread_pool.enabled="true"
				oob_thread_pool.min_threads="1" oob_thread_pool.max_threads="8"
				oob_thread_pool.keep_alive_time="5000"
				oob_thread_pool.queue_enabled="false"
				oob_thread_pool.queue_max_size="100"
				oob_thread_pool.rejection_policy="run" />
			<MPING timeout="2000" num_initial_members="2" mcast_port="34530"
				bind_addr="127.0.0.1" mcast_addr="224.0.0.1" />


			<MERGE2 max_interval="30000" min_interval="10000" />
			<FD_SOCK />
			<FD max_tries="5" shun="true" timeout="10000" />
			<VERIFY_SUSPECT timeout="1500" />
			<pbcast.NAKACK discard_delivered_msgs="true" gc_lag="0"
				retransmit_timeout="300,600,1200,2400,4800" use_mcast_xmit="false" />
			<UNICAST timeout="300,600,1200,2400,3600" />
			<pbcast.STABLE desired_avg_gossip="50000" max_bytes="400000"
				stability_delay="1000" />
			<pbcast.GMS join_timeout="5000" print_local_addr="true"
				shun="false" view_ack_collection_timeout="5000" view_bundling="true" />
			<FRAG2 frag_size="60000" />
			<pbcast.STREAMING_STATE_TRANSFER />
			<pbcast.FLUSH timeout="0" />

		</jgroupsConfig>

		<sync />
	</clustering>
   <!-- Eviction configuration -->
   <eviction wakeUpInterval="5000">
      <default algorithmClass="org.jboss.cache.eviction.FIFOAlgorithm" eventQueueSize="1000000">
         <property name="maxNodes" value="10000" />
         <property name="minTimeToLive" value="60000" />
      </default>
   </eviction>

</jbosscache>